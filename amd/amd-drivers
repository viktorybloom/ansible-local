#!/bin/bash

# Function to confirm reboot
confirm_reboot() {
    read -r -p "Do you want to reboot now? (yes/no): " choice
    case "$choice" in
        y|Y|yes|Yes|YES) reboot_now=true;;
        *) reboot_now=false;;
    esac
}

# Update system
sudo pacman -Syu --noconfirm

# Install required packages
sudo pacman -S linux-headers base-devel --noconfirm

# Identify GPU
gpu_info=$(lspci | grep 'Display controller')
echo "GPU Information: $gpu_info"

# Install AMDGPU driver
sudo pacman -S xf86-video-amdgpu --noconfirm

# Enable Kernel Module
sudo sed -i 's/MODULES=()/MODULES=(amdgpu)/' /etc/mkinitcpio.conf
sudo mkinitcpio -P

# Confirm reboot
confirm_reboot

# Display message and reboot if chosen
if [ "$reboot_now" = true ]; then
    echo "Rebooting the system..."
    sudo reboot
else
    echo "Please reboot your system later to apply the changes."
fi
